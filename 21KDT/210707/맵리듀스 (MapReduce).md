# 맵리듀스 (MapReduce)

## 맵 리듀스 개념 정리

구글에서 대용량 데이터 처리를 분산 병렬 컴퓨팅에서 처리하기 위한 목적으로 제장한 소프트웨어 프레임 워크

간단히 설명하면, 한 명이 4주에 작업할 일을 4명이 나누어 1주일에 끝내는 것

- 이 개념이 하둡에서 처리하는 병렬 처리 개념
- 4명의 작업자를 클러스터 라고 한다.

빅데이터에서 프로세스는 최대한 단순해야 한다. 프로세스를 간단하기 위해서는 기준이 되는 값을 하나로 잡아야 한다.

**맵리듀스 = 맵 + 리듀스**

맵에서는 key value를 이용하는데, key값을 이용시

- 정렬과 그룹화가 간편해지는 장점이 있다.

이를 사용하는 것이 맵 구조를 이용하는 것이다.



맵리듀스 Job들은 JobTracker에 의해 제어된다. 잡트래커는 마스터 노드에 존재한다. 이 잡 트래커가 클러스터의 다른 노드들에 맵과 리듀스 task를 할당한다.

  

### 맵 리듀스의 과정

Input → Splitting → Mapping → Shuffing → Reducing → Final Result

- input : 데이터를 입력하는 과정
- Splitting : 데이터를 쪼개어 HDFS(Hadoop Distributed File System)에 저장하는 과정
- Shuffing : 맵 함수의 결과를 취합하기 위해 리듀스 함수로 데이터를 전달하는 과정. 셔플링은 맵 태스크와 리듀스 태스크의 중간 단계
- Reducing : 모든 값을 합쳐서 우리가 원하는 값을 추출할 수 있다.

![img](https://t1.daumcdn.net/cfile/tistory/99F6AA445B5975A320)

### 맵 리듀스 간략 표현

![img](https://t1.daumcdn.net/cfile/tistory/9903C04D5B6022D50F)

### 간단하고 직관적으로 표현

맵 태스크에서 각자의 방식으로 음식을 썰고, 리듀스 태스크에서 다시 합하여 원하는 결과 얻어내는 방법

![img](https://t1.daumcdn.net/cfile/tistory/99FC4B345B62DEB71C)





# Map Reduce

![img](https://mblogthumb-phinf.pstatic.net/20131028_34/jevida_13829279643331eXTr_PNG/1.png?type=w2)

구글에서 정보 검색을 위한 데이터 가공(색인어 추출, 정렬 및 역인덱스 생성)을 목적으로 개발된 분산 환경에서의 병렬 데이터 처리 기법이자 프로그래밍 모델

맵리듀스는 비공유 구조로 연결된 여러 노드 PC들을 가지고 대량의 병렬처리 방식(MPP)으로 대용량 데이터를 처리할 수 있는 방법을 제공한다.

맵리듀스는 LISP 프로그래밍 언어에서 맵(map)과 리듀스(reduce)라는 함수의 개념을 차용하여 시스템의 분산구조를 감추면서 범용 프로그래밍 언어를 이용해 병렬 프로그래밍을 가능하게 한다.

즉, 

- 맵과 리듀스라는 두 개의 메소드로 구성되어 있다.

- 맵 : 키-값을 읽어 필터링 하거나 다른 값으로 변환하는 작업 수행
- 리듀스 : 맵 함수를 통해 출력된 결과 값을 새로운 키 기준으로 그룹화 한 후 집계연산을 수행한 결과 출력



## 맵리듀스(MapReduce)의 처리 흐름

![img](https://mblogthumb-phinf.pstatic.net/20131028_83/jevida_1382927964609KCJXE_PNG/2.png?type=w2)

맵 리듀스 수행 시 파일 시스템의 각 청크들은 맵 함수를 수행하는 Mapper 태스크(task)에 할당된다. 

Mapper는 여러 노드에 분산되어 있으며 각기 청크를 받아 map함수를 수행하여 결과를 각 mapper가 수행된 로컬 디스크에 기록한다.

만약 처리할 청크가 남아 있으면 유휴 mapper에게 청크를 할당하여 부하를 분산한다.

모든 청크가 처리 되었다면 맵리듀스 스케쥴러라는 Reducer 태스크를 수행한다.

리듀스는 여러 노드들로부터 처리해야 할 키 값을 이전 mapper들의 로컬 디스크로부터 읽어와 처리(그룹화, 연산)한다. 

데이터 처리 중에 장애 발생 시 mapper의 경우 같은 청크를 대상으로 다시 수행하거나 유휴한 다른 mapper가 해당 청크를 수행하여 내고장성을 지원한다. 

리듀스 장애의 경우 mapper의 작업은 건너뛰고 Reducer작업을 다시 수행한다.



## 맵리듀스(Map Reduce)의 장단점

| 장점                                                         | 단점                                                    |
| ------------------------------------------------------------ | ------------------------------------------------------- |
| 단순하고 사용이 편리                                         | 고정된 단일 데이터 흐름                                 |
| 특정 데이터 모델이나 스키마, 질의에 의존적이지 않은 유연성 (비정형 데이터 모델을 유연하게 지연) | 기존 DBMS보다 불편한 스키마, 질의, 인덱스 (기능 지원 X) |
| 저장 구조의 독립성                                           | 단순한 스케줄링                                         |
| 데이터복제에 기반한 내구성과 재수행을 통한 내고장성 확보     | 개발도구 불편함과 기술지원의 어려움                     |
| 높은 확장성                                                  | 복잡한 연산이 어려움                                    |

단점 : 상대적으로 성능이 낮다. 예를 들면, 모든 Map과정이 진행될 때까지 Reduce는 시작될 수 없다. 즉, 맵리듀스는 병렬화를 수행할 수 없으므로 성능이 낮아질 수 밖에 없다.



## 출처

https://songsunbi.tistory.com/5

https://m.blog.naver.com/jevida/140199795866

