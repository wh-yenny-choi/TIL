## π§ λ¦¬λ·°

#### λ¨Έμ‹ λ¬λ‹μ μΆ…λ¥

κ°λ… ν•μ— ν›λ ¨ν•λ”κ°€?

- μ§€λ„ ν•™μµ
- λΉ„μ§€λ„ ν•™μµ
- μ¤€μ§€λ„ ν•™μµ
- κ°•ν™” ν•™μµ
- μ „μ΄ ν•™μµ

μ‹¤μ‹κ°„μΌλ΅ μ μ§„μ μΈ ν•™μµμ„ ν•λ”μ§€?

- μ¨λΌμΈ ν•™μµ
  - λ§μ€ μ–‘μ„ λ°μ΄ν„°λ¥Ό λ¶€λ¶„μΌλ΅ λ‚λ”
  - κ°λ³„μ  λλ” μ†κ·Έλ£ΉμΌλ΅ λ°μ΄ν„°λ¥Ό μμ°¨μ μΌλ΅ κ³µκΈ‰ν•μ—¬ μ μ§„μ μΌλ΅ ν›λ ¨
- λ°°μΉ ν•™μµ
  - μ‹μ¤ν…μ΄ μ μ§„μ μΌλ΅ ν•™μµν•  μ μ—†μ
  - λ¨λ“  λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•΄ ν•™μµ
  - μ¤ν”„λΌμΈμΌλ΅ μν–‰(λ§μ€ μν–‰μ‹κ°„)

λ°μ΄ν„° λΉ„κµ vs λ¨λΈ κΈ°λ°μΈμ§€?

- μΈμ¤ν„΄μ¤ κΈ°λ° ν•™μµ
  - μ‚¬λ΅€ κΈ°λ°
  - λ°μ΄ν„° λΌλ¦¬μ λΉ„κµ
- λ¨λΈ κΈ°λ° ν•™μµ
  - λ¶„λ¥



#### μ§€λ„ β†” λΉ„μ§€λ„ ν•™μµ μ°¨μ΄

μ§€λ„ : μ •λ‹µμ„ μ¤

λΉ„μ§€λ„ : μ •λ‹µ μ•μ¤

νκ·€λ¨λΈ : μμΉν•

λ¶„λ¥λ¨λΈ : λ²”μ£Όν•

λ…λ¦½λ³€μμ€ λ³΄ν†µ μμΉν•? β

- λΉ„μ •ν• λ°μ΄ν„°κ°€ ν›¨μ”¬ λ§λ‹¤.  
- λ²”μ£Όν•(λ¬Έμν•) λ°μ΄ν„°κ°€ λ§μ

ν„μ‹¤ λ°μ΄ν„°λ” μμΉν•λ³΄λ‹¤ λ²”μ£Όν• λ°μ΄ν„°κ°€κ°€ ν›¨μ”¬ λ§λ‹¤.

λΉ„μ •ν• λ°μ΄ν„° β΅ μ •ν• λ°μ΄ν„° λ³€ν™ ν›„ λ¶„μ„ν•΄κ°€λ” κ³Όμ •μ΄ issue 

μ²΄κ³„ν™” λκ°€λ©° μ΄λ―Έμ§€ - λ­κ°€ μ•λ§κ³  λ“±λ“±



#### λ¶„λ¥λ¥Ό μ„ν• ν•™μµ λ° μμΈ΅ ν”„λ΅μ„Έμ¤

- 0 λ‹¨κ³„ : λ°μ΄ν„° μ„ΈνΈ μ¤€λΉ„
  - λ°μ΄ν„° μ„ΈνΈ λ΅λ”©, λ°μ΄ν„° ν”„λ μ„μΌλ΅ λ³€ν™
- 1λ‹¨κ³„ : λ°μ΄ν„° μ„ΈνΈ λ¶„λ¦¬
  - λ°μ΄ν„°λ¥Ό ν•™μµ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„°λ΅ λ¶„λ¦¬
  - λ³΄ν†µ 7 : 3 λΉ„μ¨λ΅ κµ¬λ¶„
- 2λ‹¨κ³„ : λ¨λΈ ν•™μµ
  - ν•™μµ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ MLμ•κ³ λ¦¬μ¦μ„ μ μ©ν•΄ λ¨λΈ ν•™μµ
- 3λ‹¨κ³„ : μμΈ΅ μν–‰
  - ν•™μµλ MLλ¨λΈμ„ μ΄μ©ν•΄ ν…μ¤νΈ λ°μ΄ν„° λ¶„λ¥(λ¶“κ½ƒ μΆ…λ¥) μμΈ΅
- 4λ‹¨κ³„ : λ¨λΈ μ„±λ¥ ν‰κ°€
  - μμΈ΅λ κ²°κ³Όκ°’κ³Ό ν…μ¤νΈ λ°μ΄ν„° μ‹¤μ  κ°’ λΉ„κµν•μ—¬ MLλ¨λΈ μ„±λ¥ ν‰κ°€



#### ν™€λ“-μ•„μ›ƒ λ°©μ‹

- λ°μ΄ν„°λ¥Ό λ‘ κ° μ„ΈνΈλ΅ λ‚λ„μ–΄ κ°κ° Trainκ³Ό Testμ„ΈνΈλ΅ μ‚¬μ©
- Trainκ³Ό Testμ λΉ„μ¨μ„ 7:3 ~ 9:1λ΅ λ„λ¦¬ μ‚¬μ©ν•λ‚, μ•κ³ λ¦¬μ¦μ νΉμ„± λ° μƒν™©μ— λ”°λΌ μ μ ν• λΉ„μ¨μ„ μ‚¬μ©
- Train - Vaildation -Testλ΅ λ‚λ„κΈ°λ„ ν•¨

![image-20210721134808855](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210721134808855.png)



# Model Selection λ¨λ“ μ†κ°

## ν•™μµ / ν…μ¤νΈ λ°μ΄ν„° μ…‹ λ¶„λ¦¬ train_test_split()

### μ‚¬μ΄ν‚·λ° model_selection λ¨λ“μ μ£Όμ” κΈ°λ¥

- ν•™μµ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ λ¶„λ¦¬
- κµμ°¨ κ²€μ¦ λ¶„ν•  λ° ν‰κ°€
- Estimatorμ ν•μ΄νΌ νλΌλ―Έν„° νλ‹



#### ν•™μµ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ λ¶„λ¦¬

νΉμ„±μ„ λ°μν•λ” μƒν” λ°μ΄ν„°λ” λ¬΄μ²™ μ¤‘μ”

- train_test_split() ν•¨μ μ‚¬μ©

#### ν•™μµ λ°μ΄ν„° μ„ΈνΈ

- λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ ν•™μµμ„ μ„ν•΄ μ‚¬μ©
- λ°μ΄ν„°μ μ†μ„±(ν”Όμ²)μ™€ κ²°μ •κ°’(λ μ΄λΈ”) λ¨λ‘ ν¬ν•¨
- ν•™μµ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ΄ λ°μ΄ν„° μ†μ„±κ³Ό κ²°μ •κ°’μ ν¨ν„΄μ„ μΈμ§€ν•κ³  ν•™μµ

#### ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ

- ν•™μµλ λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦ ν…μ¤νΈμ©
- λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ€ μ κ³µλ μ†μ„± λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ κ²°μ •κ°’ μμΈ΅
- ν•™μµ λ°μ΄ν„°μ™€ λ³„λ„μ μ„ΈνΈλ΅ μ κ³µ



#### train_test_split() ν•¨μ

train_test_split(feature_dataset, label_dataset, test_size, train_size, random_state, shuffle, stratify)

train_test_split(iris_data.data, iris_data.target, test_size = 0.3, random_state = 4)

- feature_dataset : ν”Όμ² λ°μ΄ν„° μ„ΈνΈ
  - ν”Όμ²(feature) λ§μΌλ΅ λ λ°μ΄ν„° (numpy)
- label_dataset : λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ
  - λ μ΄λΈ”(κ²°μ • κ°’) λ°μ΄ν„° (numpy)
- test_size : ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ λΉ„μ¨
  - μ „μ²΄ λ°μ΄ν„° μ„ΈνΈ μ¤‘ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈ λΉ„μ¨
  - μ§€μ •ν•μ§€ μ•μΌλ©΄ β‡’ 0.25
- train_size : ν•™μµμ© λ°μ΄ν„° μ„ΈνΈ λΉ„μ¨
  - κµ³μ΄ μ„¤μ • μ•ν•΄λ„ λ¨
- random_state : λ‚μ λ°μƒκ°’
  - μν–‰ν•  λ•λ§λ‹¤ λ™μΌν• λ°μ΄ν„° μ„ΈνΈλ΅ λ¶„λ¦¬ν•κΈ° μ„ν•΄ μ‹λ“(seed)κ°’ κ³ μ •
  - 0 λλ” 4κ°€ κ°€μ¥ λ§μ΄ μ‚¬μ©
  - ν•μ΄νΌ νλΌλ―Έν„° νλ‹μ‹ μ΄ κ°’μ„ κ³ μ •ν•΄λ‘κ³  νλ‹ν•΄μ•Ό λ§¤λ² λ°μ΄ν„°μ…‹μ΄ λ³€κ²½λλ” κ²ƒμ„ λ°©μ§€ν•  μ μμ
- shuffle : λ¶„ν• ν•κΈ° μ „μ— μ„μ„μ§€ μ§€μ •
  - default = True (λ³΄ν†µμ€ λ””ν΄νΈ κ°’μΌλ΅ λ†”λ‘ )
- stratify : μ§€μ •λ λ μ΄λΈ”μ ν΄λμ¤ λΉ„μ¨μ— λ§κ² λ¶„ν• 
  - default = None
  - classificationμ„ λ‹¤λ£° λ• λ§¤μ° μ¤‘μ”ν• μµμ…κ°’
  - stratifyκ°’μ„ targetμΌλ΅ μ§€μ •ν•΄μ£Όλ©΄ κ°κ°μ classλΉ„μ¨(ratio)μ„ train / validationμ— μ μ§€ν•΄ μ¤(ν• μ½μ— μ λ ¤μ„ λ¶„λ°°λλ” κ²ƒμ„ λ°©μ§€)
  - μ΄ μµμ…μ„ μ§€μ •ν•΄ μ£Όμ§€ μ•κ³  classification λ¬Έμ λ¥Ό λ‹¤λ£¬λ‹¤λ©΄, μ„±λ¥μ μ°¨μ΄κ°€ λ§μ΄ λ‚ μ μμ



#### **train_test_split()** λ°ν™κ°’ 

- X_train : ν•™μµμ© ν”Όμ² λ°μ΄ν„° μ„ΈνΈ (feature)
- X_test : ν…μ¤νΈμ© ν”Όμ² λ°μ΄ν„° μ„ΈνΈ (feature)
- y_train : ν•™μµμ© λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ (target)
- y_test : ν…μ¤νΈμ© λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈ (target)
- feature : λ€λ¬Έμ X_
- label(target) : μ†λ¬Έμ y_



### ν•™μµ  / ν…μ¤νΈ λ°μ΄ν„° μ…‹ λ¶„λ¦¬ μ‹ λ¬Έμ μ  

ν™€λ“-μ•„μ›ƒ λ°©μ‹ μ‚¬μ©μ‹ λ¬Έμ μ  λ°μƒ

- κ³Όμ ν•© λ¬Έμ  λ°μƒ
- λ¶€μ ν•©ν• λ°μ΄ν„° μ„ λ³„λ΅ μΈν• μ•κ³ λ¦¬μ¦ μ„±λ¥ μ €ν•

#### κ³Όμ ν•© (Overfitting)

λ¨λΈμ΄ ν•™μµ λ°μ΄ν„°μ— κ³Όλ„ν•κ² μµμ ν™” λμ–΄ λ‹¤λ¥Έ λ°μ΄ν„°λ΅ μ‹¤μ  μμΈ΅μ„ μν–‰ν•  κ²½μ° μμΈ΅ μ„±λ¥μ΄ κ³Όλ„ν•κ² λ–¨μ–΄μ§€λ” κ²ƒ

#### κ³Όμ ν•© λ¬Έμ  λ°μƒ

κ³ μ •λ ν•™μµ λ°μ΄ν„°μ™€ ν…μ¤νΈ λ°μ΄ν……λ§ μµμ μ μ„±λ¥μ„ λ°νν•  μ μλ„λ΅ νΈν–¥λκ² λ¨λΈμ„ μ λ„ν•λ” κ²½ν–¥ λ°μƒ

κ²°κµ­, ν•΄λ‹Ή ν…μ¤νΈ λ°μ΄ν„°λ§ κ³Όμ ν•© λλ” ν•™μµ λ¨λΈμ΄ λ§λ“¤μ–΄μ Έμ„ λ‹¤λ¥Έ ν…μ¤νΈμ© λ°μ΄ν„°κ°€ λ“¤μ–΄μ¬ κ²½μ° μ„±λ¥ μ €ν• λ°μƒ

#### λ¶€μ ν•©ν• λ°μ΄ν„° μ„ λ³„λ΅ μΈν• λ¬Έμ μ 

MLμ€ λ°μ΄ν„°μ— κΈ°λ°ν•κ³ , λ°μ΄ν„°λ” μ΄μƒμΉΒ·λ¶„ν¬λ„Β·λ‹¤μ–‘ν• μ†μ„±κ°’Β·ν”Όμ² μ¤‘μ”λ„ λ“± MLμ— μν–¥μ„ λ―ΈμΉλ” λ‹¤μ–‘ν• μ”μ†λ¥Ό κ°€μ§€κ³  μμ

νΉμ • MLμ•κ³ λ¦¬μ¦μ— μµμ μΌλ΅ λ™μ‘ν•  μ μλ„λ΅ λ°μ΄ν„°λ¥Ό μ„ λ³„ν•΄μ„ ν•™μµν•λ‹¤λ©΄ μ‹¤μ  λ°μ΄ν„° μ–‘μ‹κ³Όλ” λ§μ€ μ°¨μ΄κ°€ μμ„ κ²ƒμ΄κ³  κ²°κµ­ μ„±λ¥ μ €ν•λ΅ μ΄μ–΄μ§ κ²ƒμ„



#### λ¬Έμ μ  κ°μ„ 

**κµμ°¨ κ²€μ¦**μ„ μ΄μ©ν•΄ λ” λ‹¤μ–‘ν• ν•™μµ ν‰κ°€ μν–‰



## Data splitκ³Ό λ¨λΈ κ²€μ¦

### κµμ°¨κ²€μ¦ (Cross Vaildation, CV)

- k-fold Cross Vaildation μ΄λΌκ³ λ„ ν•¨
- μ „μ²΄ λ°μ΄ν„° μ„ΈνΈλ¥Ό μ„μλ΅ kκ°μ κ·Έλ£ΉμΌλ΅ λ‚λ„κ³ , κ·Έ κ°€μ΄λ° ν•λ‚μ κ·Έλ£Ήμ„ λμ•„κ°€λ©΄μ„ ν…μ¤νΈ λ°μ΄ν„° μ„ΈνΈλ΅, λ‚λ¨Έμ§€ k-1κ° κ·Έλ£Ήμ€ ν•™μµμ© λ°μ΄ν„° μ„ΈνΈλ΅ μ‚¬μ©ν•λ” λ°©λ²•
- λ³„λ„μ μ—¬λ¬ μ„ΈνΈλ΅ κµ¬μ„±λ ν•™μµ λ°μ΄ν„° μ„ΈνΈμ™€ κ²€μ¦ λ°μ΄ν„° μ„ΈνΈμ—μ„ ν•™μµκ³Ό ν‰κ°€λ¥Ό μν–‰

10λ² λ°λ³µ

![image-20210722102244318](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210722102244318.png)

#### κµμ°¨ κ²€μ¦ μ‚¬μ© λ©μ 

- λ°μ΄ν„°μ— μ ν•©ν• μ•κ³ λ¦¬μ¦μΈμ§€ ν‰κ°€ν•κΈ° μ„ν•΄ 
- λ¨λΈμ— μ μ ν• hyperparameter μ°ΎκΈ° μ„ν•΄
- κ³Όλ€μ ν•© μλ°©
- <u>λ°μ΄ν„° νΈμ¤‘μ„ λ§‰κΈ° μ„ν•΄</u>



#### κµμ°¨ κ²€μ¦ λ°©λ²•

- K ν΄λ“ κµμ°¨ κ²€μ¦
- Stratified K ν΄λ“ κµμ°¨ κ²€μ¦



### K ν΄λ“ κµμ°¨ κ²€μ¦

- Kκ°μ λ°μ΄ν„° ν΄λ“ μ„ΈνΈλ¥Ό λ§λ“¤μ–΄μ„
- Kλ² λ§νΌ κ° ν΄λ“ μ„ΈνΈμ— ν•™μµκ³Ό κ²€μ¦ ν‰κ°€λ¥Ό λ°λ³µμ μΌλ΅ μν–‰
- κ°€μ¥ λ³΄νΈμ μΌλ΅ μ‚¬μ©λλ” κµμ°¨ κ²€μ¦ κΈ°λ²•

5-ν΄λ“ κµμ°¨ κ²€μ¦

![image-20210722102400864](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210722102400864.png)



#### K ν΄λ“ κµμ°¨ κ²€μ¦ ν”„λ΅μ„Έμ¤ κµ¬ν„μ„ μ„ν• μ‚¬μ΄ν‚·λ° ν΄λμ¤

1οΈβƒ£ KFold ν΄λμ¤ : ν΄λ“ μ„ΈνΈλ΅ λ¶„λ¦¬ν•λ” κ°μ²΄ μƒμ„±

 - kfold = KFold(n_splits = 5)

2οΈβƒ£ split() λ©”μ†λ“ : ν΄λ“ λ°μ΄ν„° μ„ΈνΈλ΅ λ¶„λ¦¬

	- kfold.split(features)
	- κ° ν΄λ“λ§λ‹¤ ν•™μµμ©, κ²€μ¦μ©, ν…μ¤νΈ λ°μ΄ν„° μ¶”μ¶
	- ν•™μµμ© λ° μμΈ΅ μν–‰
	- μ •ν™•λ„ μΈ΅μ •

3οΈβƒ£ μµμΆ… ν‰κ·  μ •ν™•λ„ κ³„μ‚°



### λ¶κ· ν•ν• λ°μ΄ν„°(imbalanced)

κ΄€μ‹¬ λ€μƒ λ°μ΄ν„°κ°€ μƒλ€μ μΌλ΅ λ§¤μ° μ μ€ λΉ„μ¨λ΅ λ‚νƒ€λ‚λ” λ°μ΄ν„°μ λ¬Έμ 

- λ¶„λ¥ λ¬Έμ μΈ κ²½μ° : ν΄λμ¤λ“¤μ΄ κ· μΌν•κ² λ¶„ν¬ν•μ§€ μ•μ€ λ¬Έμ λ¥Ό μλ―Έ
  - μ. λ¶λ‰λ¥ μ΄ 1%μΈ μƒμ‚°λΌμΈμ—μ„ μ–‘ν’κ³Ό λ¶λ‰ν’μ„ μμΈ΅ν•λ” λ¬Έμ 
  - μ‚¬κΈ°κ°μ§€νƒμ§€, μ΄μƒκ±°λνƒμ§€, μλ£μ§„λ‹¨ λ“±μ—μ„ μμ£Ό λ‚νƒ€λ‚¨

- νκ·€ λ¬Έμ μΈ κ²½μ° : κ·Ήλ‹¨κ°’μ΄ ν¬ν•¨λμ–΄ μλ” "<u>μΉμ°μΉ</u>" λ°μ΄ν„° μ°¨λ΅€
  - μ. μ‚°λ¶μ— μν• ν”Όν•΄ λ©΄μ μ„ μμΈ΅ν•λ” λ¬Έμ 

#### μ°ν / κ·Ήλ³µν•λ” λ°©λ²•

λ°μ΄ν„° μ¶”κ°€ ν™•λ³΄

Re-Sampling 

- Under Sampling (**κ³Όμ†ν‘μ§‘**)
  - λ‹¤λ¥Έ ν΄λμ¤μ— λΉ„ν•μ—¬ μƒλ€μ μΌλ΅ λ§μ΄ λ‚νƒ€λ‚λ” ν΄λμ¤μ κ°μλ¥Ό μ¤„μ„
  - κ· ν•μ€ μ μ§€ν•  μ μμΌλ‚ μ μ©ν• μ •λ³΄μ— λ€ν• μ†μ‹¤μ΄ μμ„ μ μμ

- Over Sampling (**κ³Όλ€ν‘μ§‘**)
  - μƒλ€μ μΌλ΅ μ κ² λ‚νƒ€λ‚λ” ν΄λμ¤μ λ°μ΄ν„°λ¥Ό λ³µμ ν•μ—¬ λ°μ΄ν„°μ κ°μλ¥Ό λλ¦Ό
  - μ •λ³΄ μ†μ‹¤μ€ μ—†μ΄ ν•™μµ μ„±λ¥μ€ λ†’μ•„μ§€λ” λ°λ©΄, κ³Όμ ν•©μ μ„ν—μ΄ μμ
  - μ΄λ¥Ό νν”Όν•κΈ° μ„ν•΄μ„ SMOTEμ™€ κ°™μ΄ μ„μμ κ°’μ„ μƒμ„±ν•μ—¬ μ¶”κ°€ν•λ” λ°©λ²• μ‚¬μ©

![image-20210722110929840](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210722110929840.png)

- λ¨Όμ € K ν΄λ“ λ¬Έμ μ  ν™•μΈν•κ³ , μ‚¬μ΄ν‚·λ°μ Stratified K ν΄λ“ κµμ°¨ κ²€μ¦ λ°©λ²•μΌλ΅ κ°μ„ 
- λ¶“κ½ƒ λ°μ΄ν„° μ„ΈνΈλ¥Ό DataFrameμΌλ΅ μƒμ„±ν•κ³  λ μ΄λΈ” κ°’μ λ¶„ν¬λ„ ν™•μΈ



### Stratified K ν΄λ“ κµμ°¨ κ²€μ¦

λ¶κ· ν•ν• λ¶„ν¬λ„λ¥Ό κ°€μ§„ λ μ΄λΈ”(κ²°μ • ν΄λμ¤) λ°μ΄ν„° μ§‘ν•©μ„ μ„ν• Kν΄λ“ λ°©μ‹



#### StratifiedKFold ν΄λμ¤

μ›λ³Έ λ°μ΄ν„°μ λ μ΄λΈ” λ¶„ν¬λ¥Ό κ³ λ ¤ν• λ’¤ μ΄ λ¶„ν¬μ™€ λ™μΌν•κ² ν•™μµκ³Ό κ²€μ¦λ°μ΄ν„° μ„ΈνΈλ¥Ό λ¶„λ°°

KFold μ‚¬μ©λ²•κ³Ό κ±°μ λΉ„μ·

- μ°¨μ΄μ 
  - λ μ΄λΈ” λ°μ΄ν„° λ¶„ν¬λ„μ— λ”°λΌ ν•™μµ / κ²€μ¦ λ°μ΄ν„°λ¥Ό λ‚λ„κΈ° λ•λ¬Έμ—,
  -  split() λ©”μ„λ“μ— μΈμλ΅ ν”Όμ² λ°μ΄ν„° μ„ΈνΈ λΏ μ•„λ‹λΌ <u>λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈλ„ λ°λ“μ‹ ν•„μ”</u>



#### Stratified K ν΄λ“μ κ²½μ°

μ›λ³Έ λ°μ΄ν„°μ λ μ΄λΈ” λ¶„ν¬λ„ νΉμ„±μ„ λ°μν• ν•™μµ λ° κ²€μ¦ λ°μ΄ν„° μ„ΈνΈλ¥Ό λ§λ“¤ μ μμΌλ―€λ΅ μ™κ³΅λ λ μ΄λΈ” λ°μ΄ν„° μ„ΈνΈμ—μ„λ” λ°λ“μ‹ Stratified K ν΄λ“λ¥Ό μ΄μ©ν•΄μ„ κµμ°¨ κ²€μ¦ν•΄μ•Ό ν•¨

μΌλ°μ μΌλ΅ λ¶„λ¥(Classification)μ—μ„μ κµμ°¨ κ²€μ¦μ€ K ν΄λ“κ°€ μ•„λ‹λΌ Stratified K ν΄λ“λ΅ λ¶„ν•  λμ–΄μ•Ό ν•¨

νκ·€(Regression)μ—μ„λ” Stratified K ν΄λ“ μ§€μ›λμ§€ μ•μ

- μ΄μ  : νκ·€μ κ²°μ •κ°’μ€ μ΄μ‚°κ°’ ν•νƒμ λ μ΄λΈ”μ΄ μ•„λ‹λΌ μ—°μ†λ μ«μκ°’μ΄κΈ° λ•λ¬Έμ— κ²°μ •κ°’λ³„λ΅ λ¶„ν¬λ¥Ό μ •ν•λ” μλ―Έκ°€ μ—†κΈ° λ•λ¬Έ



## κµμ°¨κ²€μ¦μ„ λ³΄λ‹¤ κ°„νΈν•κ²

### cross_val_score() ν•¨μ

- 1 ~ 3λ‹¨κ³„μ κµμ°¨ κ²€μ¦ κ³Όμ •μ„ ν•κΊΌλ²μ— μν–‰
- λ‚΄λ¶€μ—μ„ Estimatorλ¥Ό ν•™μµ(fit), μμΈ΅(predict), ν‰κ°€(ecaluation) μ‹μΌμ£Όλ―€λ΅ κ°„λ‹¨ν•κ² κµμ°¨ κ²€μ¦ μν–‰ κ°€λ¥

#### ν•¨μ ν•μ‹

cross_val_score(esimator, X, y = None, scoring = None, cv = None, n_jobs = 1, verbose = 0, fit_params = None, pre_dispatch = '2*n_jobs')

 **cross_val_score(dt_clf, feature, label, scoring='accuracy', cv = 3)**

- estimort : Classifier λλ” Regressor
- X : feature dataset
- y : lable dataset
- scoring : μμΈ΅ μ„±λ¥ ν‰κ°€ μ§€ν‘
- cv : κµμ°¨ κ²€μ¦ ν΄λ“ μ

ClassifierμΈ κ²½μ°

- Stratified KFold λ°©μ‹μΌλ΅ λ¶„ν• 

RegressμΈ κ²½μ°

- KFold λ°©μ‹μΌλ΅ λ¶„ν• 

![image-20210722114537979](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210722114537979.png)

#### ν•¨μ λ°ν™κ°’

- scoring νλΌλ―Έν„°λ΅ μ§€μ •λ μ„±λ¥ μ§€ν‘ μΈ΅μ •κ°’μ„ λ‹΄μ€ λ°°μ—΄



#### λ¶“κ½ƒ μλ£λ¥Ό 3κ° ν΄λ“λ΅ λ¶„ν• ν•μ—¬ ν•™μµ λ° κ²€μ¦ (cv = 3)

- cross_val_score()λ” cvλ΅ μ§€μ •λ νμλ§νΌ
- scoring νλΌλ―Έν„°λ΅ μ§€μ •λ ν‰κ°€ μ§€ν‘λ΅ ν‰κ°€ κ²°κ³Όκ°’μ„ λ°°μ—΄λ΅ λ°ν™
- μΌλ°μ μΌλ΅ ν‰κ°€ κ²°κ³Όκ°’ ν‰κ· μ„ ν‰κ°€ μμΉλ΅ μ‚¬μ©



### κµμ°¨ κ²€μ¦κ³Ό μµμ μ ν•μ΄νΌ νλΌλ―Έν„° νλ‹μ„ ν•λ²μ—

#### ν•μ΄νΌ νλΌλ―Έν„°(Hyper parameter)

- λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ„ κµ¬μ„±ν•λ” μ”μ†
- μ΄ κ°’λ“¤μ„ μ΅°μ •ν•΄ μ•κ³ λ¦¬μ¦μ μμΈ΅ μ„±λ¥μ„ κ°μ„ ν•  μ μμ



#### μ‚¬μ΄ν‚·λ°μ GridSearchCV ν΄λμ¤

Classifier λ‚ Regressorμ™€ κ°™μ€ μ•κ³ λ¦¬μ¦μ— μ‚¬μ©λλ” ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μμ°¨μ μΌλ΅ μ…λ ¥ν•λ©΄μ„ μµμ μ νλΌλ―Έν„°λ¥Ό νΈλ¦¬ν•κ² λ„μ¶ν•  μ μλ” λ°©λ²• μ κ³µ

- Gridλ” κ²©μλΌλ” μλ―Έ 
  - μ΄μ΄ν•κ² νλΌλ―Έν„°λ¥Ό μ…λ ¥ν•λ©΄μ„ ν…μ¤νΈ ν•λ” λ°©μ‹
  - κ²©μ μ μ΄ xμ™€ yμ— ν•΄λ‹Ήν•λ” κ°’

μ¦‰, λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ μ—¬λ¬ ν•μ΄νΌ νλΌλ―Έν„°λ¥Ό μμ°¨μ μΌλ΅ λ³€κ²½ν•λ©΄μ„ μµκ³  μ„±λ¥μ„ κ°€μ§€λ” νλΌλ―Έν„°λ¥Ό μ°Ύκ³ μ ν•λ‹¤λ©΄ νλΌλ―Έν„°μ μ§‘ν•©μ„ λ§λ“¤μ–΄ μμ°¨μ μΌλ΅ μ μ©ν•λ©΄μ„ μµμ ν™” μν–‰



#### GridSearchCV ν΄λμ¤ μƒμ„±μμ μ£Όμ” νλΌλ―Έν„°

```sql
GridSearchCV(dt_clf, param_grid = parameters, cv = 3, refit = True, return_train_score = True)
```

- estimator : classifier, regressor, peipeline
- param_grid : key + λ¦¬μ¤νΈ κ°’μ„ κ°€μ§€λ” λ”•μ…”λ„λ¦¬ (estimator νλ‹μ„ μ„ν• ν•μ΄νΌ νλΌλ―Έν„°)
  - key : νλΌλ―Έν„°λ…
  - λ¦¬μ¤νΈ κ°’ : νλΌλ―Έν„° κ°’
- scoring : μμΈ΅ μ„±λ¥μ„ μΈ΅μ •ν•  ν‰κ°€ λ°©λ²•
  - μ„±λ¥ ν‰κ°€ μ§€ν‘λ¥Ό μ§€μ •ν•λ” λ¬Έμμ—΄
  - μ : μ •ν™•λ„μΈ κ²½μ° 'accuracy'
- cv : κµμ°¨ κ²€μ¦μ„ μ„ν•΄ λ¶„ν• λλ” ν•™μµ / ν…μ¤νΈ μ„ΈνΈμ κ°μ
- refit : μµμ μ νλΌλ―Έν„°λ¥Ό μ°Ύμ€ λ’¤ μ…λ ¥λ estimator κ°μ²΄λ¥Ό ν•΄λ‹Ή ν•μ΄νΌ νλΌλ―Έν„°λ΅ μ¬ν•™μµ μ—¬λ¶€
  - λ””ν΄νΈ : True



#### νλΌλ―Έν„°(parameter)

ν•μ΄νΌ νλΌλ―Έν„°λ” λ”•μ…”λ„λ¦¬ ν•μ‹μΌλ΅ μ§€μ •

key : ν•μ΄νΌ νλΌλ―Έν„°

value : ν•μ΄νΌ νλΌλ―Έν„°μ κ°’

```sql
parameters = {'max_depth' : [1, 2, 3], 'min_samples_split' : [2, 3]}
```

min_samples_split : μμ‹ κ·μΉ™ λ…Έλ“λ¥Ό λ¶„ν• ν•΄μ„ λ§λ“λ”λ° ν•„μ”ν• μµμ† μƒν” λ°μ΄ν„° κ°μ

- min_samples_split = 4 λ΅ μ„¤μ •ν•λ” κ²½μ°
  - μµμ† μƒν” κ°μκ°€ 4κ° ν•„μ”ν•λ°, 3κ°λ§ μλ” κ²½μ°μ—λ” λ” μ΄μƒ μμ‹ κ·μΉ™ λ…Έλ“λ¥Ό μ„ν• λ¶„ν• μ„ ν•μ§€ μ•μ

νΈλ¦¬ κΉμ΄λ„ μ¤„μ–΄μ„ λ” κ°„κ²°ν• κ²°μ • νΈλ¦¬ μƒμ„±

![image-20210722132649584](λ¨Έμ‹ λ¬λ‹04 Model Selection λ¨λ“ μ†κ°.assets/image-20210722132649584.png)



gridSearchμ—μ„ νλΌλ―Έν„° κ°’μ„ λ‹¤λ¥΄κ² μ£Όμ—μ„λ• λ³€ν™” μ•κ³ μμ–΄μ•Όν•¨



### μΌλ°μ μΈ λ¨Έμ‹ λ¬λ‹ λ¨λΈ μ μ© λ°©λ²•

μΌλ°μ μΌλ΅ ν•™μµ λ°μ΄ν„°λ¥Ό GridSearchCVλ¥Ό μ΄μ©ν•΄,

 μµμ  ν•μ΄νΌ νλΌλ―Έν„° νλ‹μ„ μν–‰ν• λ’¤μ— λ³„λ„μ ν…μ¤νΈ μ„ΈνΈμ—μ„ μ΄λ¥Ό ν‰κ°€ν•λ” λ°©μ‹



## π“μ‹¤μµ

λ§¤κ°λ³€μλ¥Ό μ–΄λ–»κ² μ£Όλλƒμ— λ”°λΌ κ²°κ³Όκ°’μ΄ λ‹¬λΌμ§€λ”κ²ƒμ„ μ‹¤μµμ„ ν†µν•΄ μµνκΈ°

ν…μ¤νΈ ν•™μµ λ°μ΄ν„°λ΅ λ‚λ” - sklearnμ train test split μ‚¬μ©

νΈν–¥μ μΌμ μμ–΄ μ •ν™•λ„κ°€ λ–¨μ–΄μ§€λ―€λ΅

λ‚λ„μ–΄μ„ λ°λ³µν•΄μ„ ν…μ¤νΈ - κµμ°¨κ²€μ¦

λ¶„ν• , λ‚λ„μ–΄μ„ ν•™μµν•λ” κ΄€μ 

Kfold λ°©λ²• μ¥λ‹¨μ 

skfold λ°©λ²•

forλ¬Έ μ‚¬μ©ν•μ§€ μ•κ³  ν¨μ¨μ μ„ <u>score</u>

μµμ μ μƒνƒλ¥Ό μ°Ύλ” ν•μ΄νΌνλΌλ―Έν„° - 

ν•μ΄νΌνλΌλ―Έν„°μ— νλ‹κΉμ§€ν•λ” κµμ°¨ κ²€μ¦ λ°©μ‹μ΄ gridsearchCV

- validation

